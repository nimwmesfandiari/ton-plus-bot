<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TON Plus</title>

  <!-- Telegram WebApp (safe) -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: Tahoma, sans-serif;
    }

    :root {
      --primary: #0088cc;
      --secondary: #00a884;
      --accent: #ff9f00;
      --bg: #0f1525;
      --card: rgba(25, 35, 60, 0.9);
      --text: #fff;
      --muted: #9aa3b2;
      --shadow: 0 8px 32px rgba(0,0,0,.35);
    }

    body {
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* ØµÙØ­Ø§Øª */
    .page {
      flex: 1;
      display: none;
      padding: 30px 20px 90px;
    }

    .page.active {
      display: block;
    }

    .card {
      background: var(--card);
      border-radius: 22px;
      padding: 30px;
      box-shadow: var(--shadow);
      text-align: center;
      max-width: 360px;
      margin: auto;
    }

    h1 {
      font-size: 22px;
      margin-bottom: 20px;
      color: var(--primary);
    }

    /* Ù…Ø§ÛŒÙ† */
    #balance {
      font-size: 34px;
      font-weight: bold;
      margin: 25px 0;
      color: var(--accent);
      transition: transform .15s ease;
    }

    #mine-btn {
      width: 100%;
      padding: 18px;
      font-size: 20px;
      border-radius: 16px;
      border: none;
      cursor: pointer;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: white;
    }

    #mine-btn:active {
      transform: scale(.95);
    }

    /* Ù†ÙˆØ§Ø± Ù¾Ø§ÛŒÛŒÙ† */
    .nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 70px;
      background: rgba(15, 21, 37, .95);
      display: flex;
      justify-content: space-around;
      align-items: center;
      border-top: 1px solid rgba(255,255,255,.05);
    }

    .nav button {
      background: none;
      border: none;
      color: var(--muted);
      font-size: 14px;
      cursor: pointer;
    }

    .nav button.active {
      color: var(--primary);
    }

    .text {
      color: var(--muted);
      line-height: 1.8;
      font-size: 14px;
    }
  </style>
</head>

<body>

  <!-- HOME -->
  <div id="home" class="page active">
    <div class="card">
      <h1>â› Ù…Ø§ÛŒÙ† TON</h1>
      <div id="balance">0.000000 TON</div>
      <button id="mine-btn">Mine</button>
      <p class="text" style="margin-top:15px">Ù‡Ø± Ø¶Ø±Ø¨Ù‡ = +0.0001 TON</p>
    </div>
  </div>

  <!-- WALLET -->
  <div id="wallet" class="page">
    <div class="card">
      <h1>ğŸ’¼ Ú©ÛŒÙ Ù¾ÙˆÙ„</h1>
      <p class="text">Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø´Ù…Ø§:</p>
      <div id="wallet-balance" style="font-size:26px;margin-top:15px"></div>
    </div>
  </div>

  <!-- FRIENDS -->
  <div id="friends" class="page">
    <div class="card">
      <h1>ğŸ‘¥ Ø±ÙØ±Ø§Ù„</h1>

      <p class="text">Ù„ÛŒÙ†Ú© Ø¯Ø¹ÙˆØª Ø´Ù…Ø§:</p>

      <div id="ref-link" style="
        background:#0b1020;
        padding:12px;
        border-radius:12px;
        font-size:13px;
        word-break:break-all;
        margin:15px 0;
      ">Ø¯Ø± Ø­Ø§Ù„ Ø³Ø§Ø®Øª...</div>

      <button id="copy-ref" style="
        width:100%;
        padding:14px;
        border:none;
        border-radius:14px;
        background:var(--primary);
        color:#fff;
        font-size:16px;
        cursor:pointer;
      ">Ú©Ù¾ÛŒ Ù„ÛŒÙ†Ú©</button>

      <p class="text" style="margin-top:15px">
        ğŸ‘¤ ØªØ¹Ø¯Ø§Ø¯ Ø±ÙØ±Ø§Ù„: <span id="ref-count">0</span>
      </p>
    </div>
  </div>

  <!-- TASKS -->
  <div id="tasks" class="page">
    <div class="card">
      <h1>ğŸ¯ ØªØ³Ú©â€ŒÙ‡Ø§</h1>
      <p class="text">Ø¨Ù‡â€ŒØ²ÙˆØ¯ÛŒ...</p>
    </div>
  </div>

  <!-- NAV -->
  <div class="nav">
    <button class="active" onclick="showPage('home', this)">Home</button>
    <button onclick="showPage('wallet', this)">Wallet</button>
    <button onclick="showPage('friends', this)">Friends</button>
    <button onclick="showPage('tasks', this)">Tasks</button>
  </div>

  <script>
    /* ====== PAGE SWITCH ====== */
    function showPage(id, btn) {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.getElementById(id).classList.add('active');

      document.querySelectorAll('.nav button').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      if (id === "wallet") {
        walletBalance.textContent = balance.toFixed(6) + " TON";
      }
    }

    /* ====== MINE ====== */
    let balance = 0;
    const saved = localStorage.getItem("ton_balance");
    if (saved) balance = parseFloat(saved);

    const balanceEl = document.getElementById("balance");
    const walletBalance = document.getElementById("wallet-balance");
    const mineBtn = document.getElementById("mine-btn");

    function renderBalance() {
      balanceEl.textContent = balance.toFixed(6) + " TON";
      balanceEl.style.transform = "scale(1.1)";
      setTimeout(() => balanceEl.style.transform = "scale(1)", 120);
    }

    renderBalance();

    mineBtn.addEventListener("click", () => {
      balance += 0.0001;
      localStorage.setItem("ton_balance", balance);
      renderBalance();
    });

    /* ====== TELEGRAM & REFERRAL ====== */
    let userId = null;

    if (window.Telegram && Telegram.WebApp) {
      Telegram.WebApp.ready();
      const user = Telegram.WebApp.initDataUnsafe?.user;
      if (user) userId = user.id;
    }

    if (!userId) {
      userId = localStorage.getItem("demo_user_id");
      if (!userId) {
        userId = Math.floor(Math.random() * 1e9);
        localStorage.setItem("demo_user_id", userId);
      }
    }

    const BOT_USERNAME = "YourBotUsername"; // Ø¨Ø¹Ø¯Ø§Ù‹ Ø¹ÙˆØ¶ Ù…ÛŒâ€ŒÚ©Ù†ÛŒ
    const refLink = `https://t.me/${BOT_USERNAME}?start=${userId}`;

    document.getElementById("ref-link").textContent = refLink;

    document.getElementById("copy-ref").onclick = () => {
      navigator.clipboard.writeText(refLink);
      alert("Ù„ÛŒÙ†Ú© Ú©Ù¾ÛŒ Ø´Ø¯ âœ…");
    };

    let refCount = localStorage.getItem("ref_count");
    if (!refCount) refCount = 0;
    document.getElementById("ref-count").textContent = refCount;
  </script>

</body>
</html>

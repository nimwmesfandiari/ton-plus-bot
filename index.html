<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
<title>TON Miner</title>

<!-- Telegram WebApp -->
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:tahoma}
body{
background:#0f1525;
color:#fff;
height:100vh;
overflow:hidden;
}

/* ---------- HEADER ---------- */
header{
height:60px;
display:flex;
align-items:center;
justify-content:space-between;
padding:0 16px;
background:#121a2f;
border-bottom:1px solid #1f2a44;
}
.status{
display:flex;
align-items:center;
gap:8px;
font-size:12px;
color:#00d166;
}
.dot{
width:8px;
height:8px;
border-radius:50%;
background:#00d166;
}

/* ---------- MAIN ---------- */
main{
height:calc(100vh - 120px);
overflow:hidden;
position:relative;
}
.page{
position:absolute;
top:0;
left:0;
width:100%;
height:100%;
padding:20px;
display:none;
overflow-y:auto;
}
.page.active{display:block}

/* ---------- MINE ---------- */
.balance{
text-align:center;
margin-top:30px;
}
.balance h1{
font-size:36px;
color:#00cfff;
}
.mine-btn{
width:200px;
height:200px;
margin:30px auto;
border-radius:50%;
background:radial-gradient(circle,#00cfff,#006a9c);
display:flex;
align-items:center;
justify-content:center;
font-size:24px;
font-weight:bold;
box-shadow:0 0 40px rgba(0,200,255,.5);
user-select:none;
}

/* ---------- NAV ---------- */
nav{
height:60px;
display:flex;
background:#121a2f;
border-top:1px solid #1f2a44;
}
nav button{
flex:1;
background:none;
border:none;
color:#aaa;
font-size:12px;
}
nav button.active{color:#00cfff}

/* ---------- WALLET / FRIENDS ---------- */
.card{
background:#18213b;
border-radius:16px;
padding:16px;
margin-bottom:16px;
}
</style>
</head>

<body>

<header>
  <div class="status"><div class="dot"></div> Online</div>
  <div id="username">Guest</div>
</header>

<main>
  <!-- HOME -->
  <div class="page active" id="home">
    <div class="balance">
      <p>Balance</p>
      <h1 id="balance">0.000000</h1>
      <small>TON</small>
    </div>

    <div class="mine-btn" id="mineBtn">MINE</div>
  </div>

  <!-- WALLET -->
  <div class="page" id="wallet">
    <div class="card">
      <h3>Wallet</h3>
      <p>TON Balance:</p>
      <b id="walletBalance">0.000000</b>
    </div>
  </div>

  <!-- FRIENDS -->
  <div class="page" id="friends">
    <div class="card">
      <h3>Referral</h3>
      <p id="refLink">Open from Telegram</p>
    </div>
  </div>
</main>

<nav>
  <button class="active" data-page="home">Home</button>
  <button data-page="wallet">Wallet</button>
  <button data-page="friends">Friends</button>
</nav>

<script>
/* =========================
   TELEGRAM CONNECT
========================= */
const tg = window.Telegram?.WebApp;
let userId = "guest";

if (tg) {
  tg.ready();
  tg.expand();

  if (tg.initDataUnsafe?.user) {
    const u = tg.initDataUnsafe.user;
    userId = u.id;
    document.getElementById("username").innerText = u.first_name || "User";
    localStorage.setItem("tg_user_id", userId);
  }
}

/* =========================
   BALANCE SYSTEM
========================= */
let balance = parseFloat(localStorage.getItem("balance_"+userId)) || 0;
const balanceEl = document.getElementById("balance");
const walletEl = document.getElementById("walletBalance");

function render(){
  balanceEl.innerText = balance.toFixed(6);
  walletEl.innerText = balance.toFixed(6);
}
render();

/* =========================
   MINE (FAST TAP)
========================= */
const mineBtn = document.getElementById("mineBtn");
mineBtn.addEventListener("touchstart", mine);
mineBtn.addEventListener("click", mine);

function mine(){
  balance += 0.0001;
  localStorage.setItem("balance_"+userId, balance);
  render();
  if(tg) tg.HapticFeedback.impactOccurred("light");
}

/* =========================
   NAVIGATION
========================= */
document.querySelectorAll("nav button").forEach(btn=>{
  btn.onclick=()=>{
    document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
    document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"));
    document.getElementById(btn.dataset.page).classList.add("active");
    btn.classList.add("active");
  }
});

/* =========================
   REFERRAL
========================= */
if(userId !== "guest"){
  document.getElementById("refLink").innerText =
  "https://t.me/YOUR_BOT_USERNAME?start="+userId;
}
</script>

</body>
</html>

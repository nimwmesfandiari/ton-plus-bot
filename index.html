<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
body{margin:0;background:#050505;color:#fff;font-family:sans-serif}
.page{display:none;padding:20px}
.page.active{display:block}
.balance{font-size:34px;color:#00baff}
.mine{
  width:180px;height:180px;border-radius:50%;
  background:radial-gradient(circle,#00baff,#005b9e);
  display:flex;align-items:center;justify-content:center;
  font-size:24px;font-weight:bold;margin:40px auto;
}
nav{position:fixed;bottom:0;width:100%;display:flex;
justify-content:space-around;background:#111;padding:10px}
.nav.active{color:#00baff}
</style>
</head>

<body>

<div id="home" class="page active">
  <div class="balance" id="balance">0.000000</div>
  <div class="mine" id="mine">MINE</div>
</div>

<div id="wallet" class="page">
  <div class="balance" id="walletBalance"></div>
</div>

<div id="friends" class="page">
  Invite friends to earn more TON
</div>

<div id="tasks" class="page">
  Tasks coming soon
</div>

<nav>
  <div class="nav active" data="home">Home</div>
  <div class="nav" data="wallet">Wallet</div>
  <div class="nav" data="friends">Friends</div>
  <div class="nav" data="tasks">Tasks</div>
</nav>

<script>
Telegram.WebApp.ready();
const userId = Telegram.WebApp.initDataUnsafe.user.id;
const API = "https://YOUR_BACKEND_URL";

let balance = 0;
const bal = document.getElementById("balance");
const wbal = document.getElementById("walletBalance");

function animate(newVal){
  let start = balance;
  let t = 0;
  const i = setInterval(()=>{
    t+=0.1;
    const v = start + (newVal-start)*t;
    bal.innerText = v.toFixed(6);
    if(t>=1){clearInterval(i);balance=newVal;}
  },16);
}

fetch(API+"/user",{method:"POST",headers:{'Content-Type':'application/json'},
body:JSON.stringify({userId})})
.then(r=>r.json()).then(d=>{
  balance=d.balance;
  bal.innerText=balance.toFixed(6);
  wbal.innerText=balance.toFixed(6);
});

document.getElementById("mine").addEventListener("pointerdown",()=>{
  fetch(API+"/mine",{method:"POST",headers:{'Content-Type':'application/json'},
  body:JSON.stringify({userId})})
  .then(r=>r.json()).then(d=>{
    animate(d.balance);
    wbal.innerText=d.balance.toFixed(6);
  });
});

document.querySelectorAll(".nav").forEach(n=>{
  n.onclick=()=>{
    document.querySelectorAll(".nav").forEach(x=>x.classList.remove("active"));
    document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
    n.classList.add("active");
    document.getElementById(n.getAttribute("data")).classList.add("active");
  }
});
</script>

</body>
</html>
